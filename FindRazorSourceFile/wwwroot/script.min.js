const a={openInVSCode:!1},et="razorsource:options",l="NotFound",e="none",n=null,v="./_content/FindRazorSourceFile/",tt="findrazorsourcefile-ui",h=document,it=Node.COMMENT_NODE;let ot=!1,y=n,p=n,t,o=n,f=n,b=n,i=n;const rt={};let r=0;const k=n=>Array.isArray(n),c=(n,t)=>{for(let i in t)n.addEventListener(i,t[i])},w=(n,t)=>{for(let i in t)n.removeEventListener(i,t[i])},s=n=>n.stopPropagation(),d=(n,t)=>Object.assign(n.style,t),u=(n,t,i,r)=>{let u={};const f=h.createElement(n);t&&d(f,t);i&&Object.assign(f,i);const e=([n,t])=>(f.appendChild(n),u={...u,...t},n);return r?.forEach(n=>{if(k(n))e(n);else for(let t in n){const i=e(n[t]);u[t]=i}}),[f,u]};export const init=()=>{if(!ot){ot=!0;kt();customElements.define(tt,dt);const n=()=>{if(!document.body.querySelector(tt)){const[n]=u(tt);h.body.appendChild(n)}};Blazor.addEventListener("enhancedload",n);n();c(h,{keydown:ni});c(window,{resize:ui,storage:fi})}};const kt=()=>{const t=h.createTreeWalker(h.body,NodeFilter.SHOW_COMMENT,n);while(t.nextNode()){const n=t.currentNode;if(n.textContent==="!"){const i=Object.getOwnPropertySymbols(n);if(i.forEach(t=>{const i=n[t];y||typeof i.nodeType===undefined||(y=t);!p&&k(i)&&(p=t)}),y&&p)break}}};class dt extends HTMLElement{constructor(){super()}connectedCallback(){const i=this.attachShadow({mode:"open"}),n=gt(i);t=n;g(1);c(n.overlay,{mousemove:ht,click:ut});c(n.sourceNameTip,{mousemove:s,click:ct});c(n.settingsButton,{click:lt});c(n.settingsForm,{click:s});c(n.settingsOpenInVSCode,{click:at});bt();this.dispose=()=>{w(n.overlay,{mousemove:ht,click:ut}),w(n.sourceNameTip,{mousemove:s,click:ct}),w(n.settingsButton,{click:lt}),w(n.settingsForm,{click:s}),w(n.settingsOpenInVSCode,{click:at})}}disconnectedCallback(){this.dispose?.()}}const gt=t=>{const[i,r]=u("div",{position:"fixed",top:"0",left:"0",bottom:"0",right:"0",zIndex:"9999",backgroundColor:"transparent",borderStyle:"solid",display:e,opacity:"0",transition:"border 0.2s ease-out, box-shadow 0.2s ease-out, opacity 0.2s linear"},n,[{sourceNameTip:u("div",{position:"absolute",top:"4px",left:"4px",padding:"2px 6px",fontFamily:"sans-serif",fontSize:"12px",color:"#111",backgroundColor:"#ffc107",boxShadow:"2px 2px 4px 0px rgb(0, 0, 0, 0.5)",whiteSpace:"nowrap",display:e,transition:"opacity 0.2s ease-out"},n,[u("img",{verticalAlign:"middle",width:"16px"},{src:v+"ASPWebApplication_16x.svg"}),{sourceNameTipProjectName:u("span",{verticalAlign:"middle",marginLeft:"4px"})},u("span",{verticalAlign:"middle"},{textContent:" | "}),u("img",{verticalAlign:"middle",width:"16px"},{src:v+"ASPRazorFile_16x.svg"}),{sourceNameTipItemName:u("span",{verticalAlign:"middle",marginLeft:"4px"})}])},{settingsButton:u("button",{position:"fixed",bottom:"8px",right:"8px",height:"32px",paddingLeft:"30px",fontFamily:"sans-serif",fontSize:"12px",color:"#111",border:e,backgroundColor:"#fff",borderRadius:"64px",outline:e,backgroundImage:`url('${v}settings_black_24dp.svg')`,backgroundRepeat:"no-repeat",backgroundPosition:"5px center"},{title:"Find Razor Source File - Settings",textContent:"Find Razor Source File"})},{settingsForm:u("div",{position:"fixed",bottom:"0",right:"8px",padding:"8px 12px",border:"#ccc",backgroundColor:"#fff",borderRadius:"8px",boxShadow:"2px 2px 4px 0px rgb(0, 0, 0, 0.5)",opacity:"0",transition:"ease-out all 0.2s",pointerEvents:e},n,[u("label",{margin:"0",padding:"0",fontFamily:"sans-serif",fontSize:"12px",color:"#111"},n,[{settingsOpenInVSCode:u("input",{margin:"0 8px 0 0",padding:"0",verticalAlign:"middle"},{type:"checkbox"})},u("span",{verticalAlign:"middle"},{textContent:"Open the .razor file of the clicked component in "}),u("img",{verticalAlign:"middle",width:"18px"},{src:v+"vscode.svg"}),u("span",{verticalAlign:"middle"},{textContent:" VSCode"}),])])}]);return t.appendChild(i),{...{overlay:i},...r}},g=n=>{const i=n===1?.3:.5,r=n===1?"0.8":"1.0";d(t.overlay,{borderColor:`rgba(0, 0, 0, ${i})`,boxShadow:`inset rgb(0, 0, 0, ${i}) 0px 0px 6px 4px`});t.sourceNameTip.style.opacity=r},st=(n,i)=>{t.sourceNameTipProjectName.textContent=n,t.sourceNameTipItemName.textContent=i},ni=u=>{const o=u.code==="KeyF"&&u.ctrlKey&&u.shiftKey&&!u.metaKey&&!u.altKey,h=u.code==="Escape"&&!u.ctrlKey&&!u.shiftKey&&!u.metaKey&&!u.altKey;r===0&&o?(s(u),u.preventDefault(),r=1,d(t.overlay,{borderWidth:"50vh 50vw",display:"block"}),nt(),setTimeout(()=>{(r===1||r===2)&&(t.overlay.style.opacity="1")},1),st("",""),f=n,b=n,i=n):(r===1||r===2)&&(h||o)&&(s(u),u.preventDefault(),r=o?0:r===2?1:0,g(1),t.sourceNameTip.style.display=e,t.overlay.style.borderWidth="50vh 50vw",nt(),r===0&&(t.overlay.style.opacity="0",setTimeout(()=>{r===0&&(t.overlay.style.display=e)},200)))},ht=async n=>{r===1&&vt(n)},ut=n=>{if(nt(),r===1){if(f&&o&&o!==l){r=2;g(2);const n=new Event("razorsource:lockin",{bubbles:!1,cancelable:!1});n.razorSourceName=o;h.dispatchEvent(n);a.openInVSCode&&(window.location.href=`vscode://file/${o.fullPath}`)}}else r===2&&(r=1,g(1),vt(n))},ct=n=>{s(n),r===1&&ut(n)},lt=n=>{s(n),ii()?ti():nt()},ti=()=>Object.assign(t.settingsForm.style,{opacity:"1",bottom:"48px",pointerEvents:"unset"}),nt=()=>Object.assign(t.settingsForm.style,{opacity:"0",bottom:"0",pointerEvents:e}),ii=()=>t.settingsForm.style.opacity==="0",at=n=>{s(n),a.openInVSCode=t.settingsOpenInVSCode.checked,ei()},vt=async n=>{const t=await ri(n);t.scopeHasChanged!==!1&&(o=await pt(t.scope),wt(t.scopeRect,o))},ri=async r=>{t.overlay.style.visibility="hidden";const c=h.elementFromPoint(r.clientX,r.clientY);t.overlay.style.visibility="visible";let u=n,e=n;for(let n=c;n;n=n.parentElement)u?u===await yt(n)&&(e=n):(u=await yt(n),u&&(e=n));let o=n;if(u&&e){if(f&&f!==u&&i&&i.left<r.clientX&&r.clientX<i.right&&i.top<r.clientY&&r.clientY<i.bottom&&(o=ft(e),o.left<i.left&&o.right>i.right&&o.top<i.top&&o.bottom>i.bottom))return{scope:f,scopeRect:i,scopeHasChanged:!1}}else if(i&&i.left<r.clientX&&r.clientX<i.right&&i.top<r.clientY&&r.clientY<i.bottom)return{scope:f,scopeRect:i,scopeHasChanged:!1};const s=f!==u;return s&&(f=u,b=e,i=o||(e?ft(e):n)),{scope:f,scopeRect:i,scopeHasChanged:s}},yt=async t=>{const i=t.getAttributeNames().filter(n=>n.startsWith("b-"))[0]||n,r=await pt(i);return!r||r===l?n:i},pt=async t=>{if(!t)return n;let i=rt[t]||n;if(i)return i;const r=await fetch(`${v}RazorSourceMapFiles/${t}.txt`);if(r.ok){const u=await r.text(),n=u.replace(/[\r\n]*$/ig,"").split("|"),i={projectName:n[0],itemName:n[1],fullPath:n[2]};return rt[t]=i,i}return rt[t]=l,l},wt=(n,i)=>{if(!n||!i||i===l){t.sourceNameTip.style.display=e;t.overlay.style.borderWidth="50vh 50vw";return}const r=t.overlay.getBoundingClientRect();d(t.overlay,{borderStyle:"solid",borderTopWidth:n.top+"px",borderLeftWidth:n.left+"px",borderBottomWidth:r.height-n.bottom+"px",borderRightWidth:r.width-n.right+"px"});st(i.projectName,i.itemName);t.sourceNameTip.style.display="block"},ft=t=>{const i=t=>{const i=[n,[]];if(!y||!p)return i;const r=t[y],u=t[p];return k(r)||!r?i:!k(u)||!u?i:[r,u]},u=n=>{const[t,r]=i(n);if(t?.nodeType===it){const[,r]=i(t);return[...r,n]}return n.nodeType===it?[...r,n]:[n]},r=n=>{const u={top:9999999,left:9999999,bottom:0,right:0},t={...u};return n.forEach(n=>{const f=n.nodeType===Node.ELEMENT_NODE?n.getBoundingClientRect():n.nodeType===it?r(i(n)[1]):u;t.top=Math.min(t.top,f.top);t.left=Math.min(t.left,f.left);t.bottom=Math.max(t.bottom,f.bottom);t.right=Math.max(t.right,f.right)}),t},f=u(t);return r(f)},ui=()=>{r!==0&&f&&b&&i&&o&&o!==l&&(i=ft(b),wt(i,o))},fi=()=>bt(),ei=()=>{const n=JSON.stringify(a);localStorage.setItem(et,n)},bt=()=>{const n=localStorage.getItem(et);Object.assign(a,JSON.parse(n||"{}"));t.settingsOpenInVSCode.checked=a.openInVSCode};